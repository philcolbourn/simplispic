"Loading a associative lists ADTs..."

(define pc-adt-alist.lib #t)

; associative list ((k . v) (k . v) ...)

(define make-alist (lambda (keys vals)
  (cond ((null? keys) (if (null? vals) '() (make-alist "Not enough keys for values" vals)))
        ((atom? keys) (list (make-kvp keys vals)) )  ; key=(v v ...)
        ((null? vals) (list (make-kvp (car keys) '())
                            (make-alist (cdr keys) '())) )  ; missing values are ()
        (else (list (make-kvp (car keys) (car vals))
                    (make-alist (cdr keys) (cdr vals)))  )) 
))

(define extend-alist (lambda (kvp alst) (cons kvp alst)))

(define alist-assoc (lambda (key alst)
  ;(displayn "alist-assoc  key=[" key "]  alst=[" alst "]")
  (cond ((null? alst) #f)
        ((eq? key (kvp-key (car alst))) 
         ;(peek "found key->" (car alst))
         (car alst))
        (else (alist-assoc key (cdr alst)))  )))

(define alist-lookup (lambda (key alst)
  ;(displayn "alist-lookup  key=[" key "]  alst=[" alst "]")
  (cond ((null? alst) key)
        ((eq? key (kvp-key (car alst))) (kvp-val (car alst)))
        (else (alist-lookup key (cdr alst)))  )))
  



